# ๐ข Corporate Portal - ะะพะปะฝัะน ะกัะตะบ

ะะพัะฟะพัะฐัะธะฒะฝัะน ะฟะพััะฐะป ั ะฑัะบะตะฝะดะพะผ ะฝะฐ Go, ััะพะฝัะตะฝะดะพะผ ะฝะฐ Flutter ะธ ะฟะพะปะฝะพะน ะธะฝััะฐััััะบัััะพะน Docker.

## ๐๏ธ ะััะธัะตะบัััะฐ ัะธััะตะผั

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ  Flutter App    โ    โ   Caddy Proxy    โ    โ   Go Backend    โ
โ  (Frontend)     โโโโโบโ (back.portal.ru) โโโโโบโ   (API Server)  โ
โ                 โ    โ                  โ    โ                 โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                                โฒ                        โฒ
                                โ                        โ
                                โผ                        โผ
                       โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                       โ   Swagger UI     โ    โ   PostgreSQL    โ
                       โ  (Documentation) โ    โ   (Database)    โ
                       โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
```

## ๐ ะัััััะน ััะฐัั

### 1. ะะฐะฟััะบ ะฑัะบะตะฝะดะฐ

```bash
cd main_app_backend/Docker
./start.sh
```

### 2. ะะฐะฟััะบ ััะพะฝัะตะฝะดะฐ

```bash
cd main_app
flutter pub get
flutter run
```

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
simple-port/
โโโ main_app_backend/           # ะัะบะตะฝะด (Go + PostgreSQL + Caddy)
โ   โโโ GoServer/              # Go ะฟัะธะปะพะถะตะฝะธะต
โ   โ   โโโ src/              # ะััะพะดะฝัะน ะบะพะด
โ   โ   โโโ docs/             # Swagger ะดะพะบัะผะตะฝัะฐัะธั
โ   โ   โโโ index.go          # ะะปะฐะฒะฝัะน ัะฐะนะป
โ   โโโ caddy/                # ะะพะฝัะธะณััะฐัะธั Caddy
โ   โ   โโโ Caddyfile        # ะัะพะบัะธ ะฝะฐัััะพะนะบะธ
โ   โโโ Docker/               # Docker ะบะพะฝัะธะณััะฐัะธั
โ       โโโ docker-compose.yml
โ       โโโ start.sh          # ะกะบัะธะฟั ะทะฐะฟััะบะฐ
โ       โโโ init-db/          # ะะฝะธัะธะฐะปะธะทะฐัะธั ะะ
โ
โโโ main_app/                  # ะคัะพะฝัะตะฝะด (Flutter)
โ   โโโ lib/
โ   โ   โโโ services/         # API ัะตัะฒะธัั
โ   โ   โโโ user_category/    # ะญะบัะฐะฝั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
โ   โ   โโโ main.dart         # ะะปะฐะฒะฝัะน ัะฐะนะป
โ   โโโ pubspec.yaml
โ
โโโ README_PORTAL.md          # ะญัะพั ัะฐะนะป
```

## ๐ง ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

### ะัะบะตะฝะด

- **Go 1.21** - ะัะฝะพะฒะฝะพะน ัะทัะบ
- **Chi Router** - HTTP ัะพััะตั
- **GORM** - ORM ะดะปั ัะฐะฑะพัั ั ะะ
- **PostgreSQL 15** - ะะฐะทะฐ ะดะฐะฝะฝัั
- **Caddy 2** - Reverse proxy ะธ SSL
- **Swagger** - API ะดะพะบัะผะตะฝัะฐัะธั
- **Docker** - ะะพะฝัะตะนะฝะตัะธะทะฐัะธั

### ะคัะพะฝัะตะฝะด

- **Flutter 3.6+** - ะคัะตะนะผะฒะพัะบ UI
- **Dart** - ะฏะทัะบ ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธั
- **HTTP** - ะกะตัะตะฒัะต ะทะฐะฟัะพัั
- **SharedPreferences** - ะะพะบะฐะปัะฝะพะต ััะฐะฝะธะปะธัะต

## ๐ ะะพัััะฟะฝัะต ัะตัะฒะธัั

ะะพัะปะต ะทะฐะฟััะบะฐ ะดะพัััะฟะฝั:

| ะกะตัะฒะธั      | URL                            | ะะฟะธัะฐะฝะธะต             |
| ----------- | ------------------------------ | -------------------- |
| Go API      | http://localhost:3000          | ะัะฝะพะฒะฝะพะน API         |
| Swagger UI  | http://localhost:3000/swagger/ | ะะพะบัะผะตะฝัะฐัะธั API     |
| Caddy Proxy | http://localhost               | ะัะพะบัะธ ัะตัะฒะตั        |
| PostgreSQL  | localhost:5432                 | ะะฐะทะฐ ะดะฐะฝะฝัั          |
| Flutter App | localhost:\*                   | ะะพะฑะธะปัะฝะพะต ะฟัะธะปะพะถะตะฝะธะต |

### ะัะพะดะฐะบัะตะฝ URLs

- **API**: https://back.portal.ru
- **Swagger**: https://back.portal.ru/swagger/

## ๐ฅ ะขะตััะพะฒัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ

| Email             | ะะฐัะพะปั      | ะะพะปั          |
| ----------------- | ----------- | ------------- |
| admin@portal.ru   | password123 | ะะดะผะธะฝะธัััะฐัะพั |
| emp1@portal.ru    | password123 | ะกะพัััะดะฝะธะบ     |
| emp2@portal.ru    | password123 | ะกะพัััะดะฝะธะบ     |
| manager@portal.ru | password123 | ะะตะฝะตะดะถะตั      |

## ๐ API Endpoints

### ะััะตะฝัะธัะธะบะฐัะธั

- `POST /api/auth/register` - ะะตะณะธัััะฐัะธั
- `POST /api/auth/login` - ะะฒัะพัะธะทะฐัะธั
- `GET /api/auth/profile` - ะัะพัะธะปั ะฟะพะปัะทะพะฒะฐัะตะปั

### ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะผะพะดัะปะธ

- `/api/orders/*` - ะฃะฟัะฐะฒะปะตะฝะธะต ะทะฐะบะฐะทะฐะผะธ
- `/api/packaging/*` - ะฃะฟะฐะบะพะฒะบะฐ ัะพะฒะฐัะพะฒ
- `/api/catalog/*` - ะะฐัะฐะปะพะณ ะฟัะพะดัะบัะธะธ
- `/api/upload/*` - ะะฐะณััะทะบะฐ ัะฐะนะปะพะฒ

_ะะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะดะพัััะฟะฝะฐ ะฒ Swagger UI_

## ๐๏ธ ะะฐะทัะฐะฑะพัะบะฐ

### ะะพะบะฐะปัะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ ะฑัะบะตะฝะดะฐ

```bash
cd main_app_backend/GoServer
go mod tidy
go run index.go
```

### ะะพะบะฐะปัะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ ััะพะฝัะตะฝะดะฐ

```bash
cd main_app
flutter run -d chrome  # ะะตะฑ ะฒะตััะธั
flutter run -d android # Android
flutter run -d ios     # iOS (ัะพะปัะบะพ macOS)
```

### ะะตะฝะตัะฐัะธั Swagger ะดะพะบัะผะตะฝัะฐัะธะธ

```bash
cd main_app_backend/GoServer
swag init -g index.go --output ./docs
```

## ๐ณ Docker ะบะพะผะฐะฝะดั

```bash
# ะะฐะฟััะบ ะฒัะตั ัะตัะฒะธัะพะฒ
cd main_app_backend/Docker
docker-compose up -d

# ะัะพะดะฐะบัะตะฝ ัะตะถะธะผ
docker-compose -f docker-compose.prod.yml up -d

# ะัะพัะผะพัั ะปะพะณะพะฒ
docker-compose logs -f

# ะััะฐะฝะพะฒะบะฐ
docker-compose down

# ะะพะปะฝะฐั ะพัะธััะบะฐ (ะฒะบะปััะฐั volumes)
docker-compose down -v
```

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะัะพะฒะตัะบะฐ ัะพััะพัะฝะธั ัะตัะฒะธัะพะฒ

```bash
# ะกัะฐััั ะบะพะฝัะตะนะฝะตัะพะฒ
docker-compose ps

# Health check API
curl http://localhost:3000/health

# Health check ัะตัะตะท Caddy
curl http://localhost/health

# ะะพะณะธ ะบะพะฝะบัะตัะฝะพะณะพ ัะตัะฒะธัะฐ
docker-compose logs -f goapp
docker-compose logs -f postgres
docker-compose logs -f caddy
```

### ะะพะดะบะปััะตะฝะธะต ะบ ะฑะฐะทะต ะดะฐะฝะฝัั

```bash
# ะงะตัะตะท Docker
docker-compose exec postgres psql -U portal_user -d portal_db

# ะะพะบะฐะปัะฝะพ (ะตัะปะธ PostgreSQL ัััะฐะฝะพะฒะปะตะฝ)
psql -h localhost -U portal_user -d portal_db
```

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### ะะปั ะฟัะพะดะฐะบัะตะฝะฐ ะพะฑัะทะฐัะตะปัะฝะพ:

1. **ะกะผะตะฝะธัะต ะฟะฐัะพะปะธ ะฒ `.env`**:

   ```bash
   cd main_app_backend/Docker
   cp env.example .env
   # ะััะตะดะฐะบัะธััะนัะต .env ั ัะธะปัะฝัะผะธ ะฟะฐัะพะปัะผะธ
   ```

2. **ะะฐัััะพะนัะต firewall**:

   ```bash
   # ะขะพะปัะบะพ ะฝะตะพะฑัะพะดะธะผัะต ะฟะพััั
   ufw allow 80/tcp
   ufw allow 443/tcp
   ufw deny 5432/tcp  # PostgreSQL ัะพะปัะบะพ ะดะปั Docker ัะตัะธ
   ```

3. **SSL ัะตััะธัะธะบะฐัั**: Caddy ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟะพะปััะฐะตั ะพั Let's Encrypt

4. **JWT Secret**: ะัะฟะพะปัะทัะนัะต ะบัะธะฟัะพะณัะฐัะธัะตัะบะธ ััะพะนะบะธะน ะบะปัั

## ๐ฆ ะะตะฟะปะพะน

### ะะตะฟะปะพะน ะฑัะบะตะฝะดะฐ

```bash
# ะะฐ ัะตัะฒะตัะต
git clone <repository>
cd simple-port/main_app_backend/Docker
cp env.example .env
# ะะฐัััะพะนัะต .env
./start.sh production
```

### ะะตะฟะปะพะน ััะพะฝัะตะฝะดะฐ

```bash
# ะะตะฑ ะฒะตััะธั
cd main_app
flutter build web --release
# ะะตะฟะปะพะน ะฟะฐะฟะบะธ build/web ะฝะฐ ัะพััะธะฝะณ

# ะะพะฑะธะปัะฝัะต ะฟัะธะปะพะถะตะฝะธั
flutter build apk --release      # Android
flutter build ios --release      # iOS
```

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั (.env)

```bash
# Database
POSTGRES_PASSWORD=secure_password_here

# JWT
JWT_SECRET=very_long_random_string_here

# Domain
DOMAIN=back.portal.ru

# Environment
ENVIRONMENT=production
```

### ะะฐัััะพะนะบะฐ Caddy

ะคะฐะนะป `caddy/Caddyfile` ัะพะดะตัะถะธั ะบะพะฝัะธะณััะฐัะธั ะดะปั:

- HTTPS ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผะธ ัะตััะธัะธะบะฐัะฐะผะธ
- CORS ะทะฐะณะพะปะพะฒะบะธ ะดะปั Flutter
- ะัะพะบัะธัะพะฒะฐะฝะธะต API ะทะฐะฟัะพัะพะฒ
- ะะฑัะฐะฑะพัะบะฐ preflight ะทะฐะฟัะพัะพะฒ

## ๐ Troubleshooting

### ะงะฐัััะต ะฟัะพะฑะปะตะผั

1. **ะะต ะทะฐะฟััะบะฐะตััั PostgreSQL**:

   ```bash
   docker-compose logs postgres
   docker-compose restart postgres
   ```

2. **CORS ะพัะธะฑะบะธ ะฒะพ Flutter**:

   - ะัะพะฒะตัััะต ะฝะฐัััะพะนะบะธ ะฒ Caddyfile
   - ะฃะฑะตะดะธัะตัั ััะพ Caddy ะทะฐะฟััะตะฝ

3. **JWT ัะพะบะตะฝั ะฝะต ัะฐะฑะพัะฐัั**:

   - ะัะพะฒะตัััะต JWT_SECRET ะฒ .env
   - ะะตัะตะทะฐะฟัััะธัะต Go ะฟัะธะปะพะถะตะฝะธะต

4. **ะะต ะณะตะฝะตัะธััะตััั Swagger**:
   ```bash
   cd GoServer
   go install github.com/swaggo/swag/cmd/swag@latest
   swag init -g index.go --output ./docs
   ```

### ะะพะปะฝะฐั ะฟะตัะตัััะฐะฝะพะฒะบะฐ

```bash
# ะััะฐะฝะพะฒะบะฐ ะธ ัะดะฐะปะตะฝะธะต ะฒัะตั ะดะฐะฝะฝัั
cd main_app_backend/Docker
docker-compose down -v
docker system prune -a

# ะะพะฒัะน ะทะฐะฟััะบ
./start.sh
```

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั

- [ะัะบะตะฝะด README](main_app_backend/README.md)
- [ะคัะพะฝัะตะฝะด README](main_app/README.md)
- [Swagger UI](http://localhost:3000/swagger/) - ะฟะพัะปะต ะทะฐะฟััะบะฐ
- [API ะดะพะบัะผะตะฝัะฐัะธั](https://back.portal.ru/swagger/) - ะฟัะพะดะฐะบัะตะฝ

## ๐ค ะะพะดะดะตัะถะบะฐ

ะัะธ ะฒะพะทะฝะธะบะฝะพะฒะตะฝะธะธ ะฟัะพะฑะปะตะผ:

1. ะัะพะฒะตัััะต ะปะพะณะธ: `docker-compose logs -f`
2. ะฃะฑะตะดะธัะตัั ััะพ ะฒัะต ัะตัะฒะธัั ะทะฐะฟััะตะฝั: `docker-compose ps`
3. ะัะพะฒะตัััะต ัะตัะตะฒะพะต ะฟะพะดะบะปััะตะฝะธะต
4. ะะฑัะฐัะธัะตัั ะบ ัะพะพัะฒะตัััะฒัััะตะผั README ะดะปั ะบะพะฝะบัะตัะฝะพะณะพ ะบะพะผะฟะพะฝะตะฝัะฐ

---

**๐ ะะพัะพะฒะพ! ะะพัะฟะพัะฐัะธะฒะฝัะน ะฟะพััะฐะป ะฟะพะปะฝะพัััั ะฝะฐัััะพะตะฝ ะธ ะณะพัะพะฒ ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั.**
